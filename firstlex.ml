# 1 "firstlex.mll"
 
	type lexeme =
		| EOF
		| PLUS
		| MINUS
		| DIV
		| TIMES
		| FLOAT of float
		| IDENT of string


	let print_lexeme = function 
		| EOF  -> print_string "EOF"
		| PLUS  -> print_string "PLUS"
		| MINUS  -> print_string "MINUS"
		| DIV  -> print_string "DIV"
		| TIMES  -> print_string "TIMES"
		| FLOAT  nb -> print_string "FLOAT (";print_float nb; print_string ")"
		| IDENT  str  -> print_string "IDENT (";print_string str ; print_string ")"


open Lexing
exception Eof 
type error =
	|Illegal_character of char
	|Illegal_float of string
exception Error of error * position * position


let raise_error err lexbuf=
raise(Error(err,lexeme_start_p lexbuf , lexeme_end_p lexbuf))

let report_error = function
	|Illegal_character c ->
		print_string "Illegal character ’ ";
		print_char c;
		print_string "’";
	|Illegal_float nb ->
		print_string " The float ";
		print_string nb;
		print_string " is illegal "


let print_position debut fin =
	if(debut.pos_lnum = fin.pos_lnum) then
	   begin
		print_string "line ";
		print_int debut.pos_lnum;
		print_string " characters ";
		print_int(debut.pos_cnum - debut.pos_bol);
		print_string "-";
		print_int (fin.pos_cnum - fin.pos_bol)
	   end
	else
	   begin
		print_string "from line ";
		print_int debut.pos_lnum;
		print_string " character ";
		print_int(debut.pos_cnum - debut.pos_bol);
		print_string "to line ";
		print_int fin.pos_lnum;
		print_string " character ";
		print_int (fin.pos_cnum - fin.pos_bol)
	   end
	

# 69 "firstlex.ml"
let __ocaml_lex_tables = {
  Lexing.lex_base =
   "\000\000\246\255\075\000\150\000\162\000\249\255\250\255\251\255\
    \252\255\253\255\002\000\002\000\255\255";
  Lexing.lex_backtrk =
   "\007\000\255\255\008\000\007\000\007\000\255\255\255\255\255\255\
    \255\255\255\255\001\000\000\000\255\255";
  Lexing.lex_default =
   "\001\000\000\000\255\255\255\255\255\255\000\000\000\000\000\000\
    \000\000\000\000\255\255\255\255\000\000";
  Lexing.lex_trans =
   "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\010\000\012\000\010\000\012\000\011\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \010\000\000\000\010\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\005\000\008\000\000\000\007\000\003\000\006\000\
    \004\000\004\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\000\000\000\000\
    \000\000\000\000\002\000\000\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \003\000\000\000\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \009\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000";
  Lexing.lex_check =
   "\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\010\000\011\000\000\000\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\255\255\010\000\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\000\000\000\000\255\255\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\255\255\255\255\255\255\255\255\255\255\
    \255\255\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\
    \000\000\000\000\000\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\255\255\255\255\
    \255\255\255\255\002\000\255\255\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\002\000\002\000\
    \002\000\002\000\002\000\002\000\002\000\002\000\003\000\003\000\
    \003\000\003\000\003\000\003\000\003\000\003\000\003\000\003\000\
    \004\000\255\255\004\000\004\000\004\000\004\000\004\000\004\000\
    \004\000\004\000\004\000\004\000\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \000\000\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255\
    \255\255\255\255\255\255";
  Lexing.lex_base_code =
   "";
  Lexing.lex_backtrk_code =
   "";
  Lexing.lex_default_code =
   "";
  Lexing.lex_trans_code =
   "";
  Lexing.lex_check_code =
   "";
  Lexing.lex_code =
   "";
}

let rec nexttoken lexbuf =
   __ocaml_lex_nexttoken_rec lexbuf 0
and __ocaml_lex_nexttoken_rec lexbuf __ocaml_lex_state =
  match Lexing.engine __ocaml_lex_tables __ocaml_lex_state lexbuf with
      | 0 ->
# 82 "firstlex.mll"
          (Lexing.new_line lexbuf; nexttoken lexbuf)
# 209 "firstlex.ml"

  | 1 ->
# 83 "firstlex.mll"
         (nexttoken lexbuf)
# 214 "firstlex.ml"

  | 2 ->
# 84 "firstlex.mll"
      (EOF)
# 219 "firstlex.ml"

  | 3 ->
# 85 "firstlex.mll"
         (PLUS)
# 224 "firstlex.ml"

  | 4 ->
# 86 "firstlex.mll"
        (MINUS)
# 229 "firstlex.ml"

  | 5 ->
# 87 "firstlex.mll"
        (DIV)
# 234 "firstlex.ml"

  | 6 ->
# 88 "firstlex.mll"
        (TIMES)
# 239 "firstlex.ml"

  | 7 ->
let
# 89 "firstlex.mll"
           nb
# 245 "firstlex.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 89 "firstlex.mll"
               (try FLOAT(float_of_string nb) with Failure "float_of_string"->raise_error(Illegal_float(nb)) lexbuf)
# 249 "firstlex.ml"

  | 8 ->
let
# 90 "firstlex.mll"
            str
# 255 "firstlex.ml"
= Lexing.sub_lexeme lexbuf lexbuf.Lexing.lex_start_pos lexbuf.Lexing.lex_curr_pos in
# 90 "firstlex.mll"
                 (IDENT str)
# 259 "firstlex.ml"

  | 9 ->
let
# 91 "firstlex.mll"
        c
# 265 "firstlex.ml"
= Lexing.sub_lexeme_char lexbuf lexbuf.Lexing.lex_start_pos in
# 91 "firstlex.mll"
          (raise_error(Illegal_character(c)) lexbuf)
# 269 "firstlex.ml"

  | __ocaml_lex_state -> lexbuf.Lexing.refill_buff lexbuf;
      __ocaml_lex_nexttoken_rec lexbuf __ocaml_lex_state

;;

# 93 "firstlex.mll"
 


let rec examine_all lexbuf =
let res = nexttoken lexbuf in 
print_lexeme res;
print_string "";
match res with 
|EOF -> ()
|_ -> examine_all lexbuf


(* code pour lire le fichier dont le nom est passé en param *)
let compile file = 
print_string("File"^file^"is being treated!\n");
try
	let input_file = open_in file in 
	let lexbuf = Lexing.from_channel input_file in 
	try		
		examine_all lexbuf;
		print_newline ();
		close_in(input_file)
	with
	|Error(kind,debut,fin)->
		close_in(input_file);
		report_error kind;
		print_position debut fin;
		print_newline()


with Sys_error s-> print_endline("can't find file '"^ file ^"'")

let _ = Arg.parse [] compile ""

# 311 "firstlex.ml"
